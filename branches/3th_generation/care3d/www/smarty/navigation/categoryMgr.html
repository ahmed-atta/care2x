<flexy:include src="publisherSubNav.html" />

<h1 class="$result->pageTitle">{$result->translate($result->pageTitle)}</h1>
<p><span flexy:if="msgGet()">{$result->msgGet()}</span></p>

{$result->if:noEditForm}
<table class="wide">
    <tr>
        <td><p><strong>{$result->translate('Welcome to Category Manager')},</strong></p>
            <p>
                <input type="button"  name="category" value="{$result->translate('Reorder Categories')}" 
                    onclick="document.location.href = '{$result->makeUrl('reorder','category','navigation')}'" />
                <input type="button"  name="category" value="{$result->translate('Add Root Category')}" 
                    onclick="document.location.href = '{$result->makeUrl('insert','category','navigation','','frmCatID|0')}'" />
            </p>
            <p>{$result->translate('Please choose a category from the left to edit')}.<br /></p>
        </td>
    </tr>
    <tr>
        <td height="1">&nbsp;</td>
    </tr>
</table>
{$result->else:}
<table class="wide">
    <form name="frmCategoryMgr" action="" method="post" flexy:ignore id="frmCategoryMgr">
    <input type="hidden" name="action" value="update" />
    <input type="hidden" name="category[category_id]" value="{$result->category[category_id]}" />
    <input type="hidden" name="category[order_id]" value="{$result->category[order_id]}" />
    <input type="hidden" name="category[original_parent_id]" value="{$result->category[parent_id]}" />
        <tr>
            <td colspan="2">
            <strong>{$result->translate('You are here')}:</strong><br />{$result->breadCrumbs:h}<br /><br />
            </td>
        </tr>

        <tr>
            <td colspan="2">
                <input type="button"  name="category" value="{$result->translate('Add Category')}" 
                    onclick="document.location.href = '{$result->makeUrl('insert','category','navigation','','frmCatID|category[category_id]')}'" />
                <input type="button"  name="category" value="{$result->translate('Add Root Category')}" 
                    onclick="document.location.href = '{$result->makeUrl('insert','category','navigation','','frmCatID|0')}'" />
                <input type="button"  name="category" value="{$result->translate('Reorder Categories')}" 
                    onclick="document.location.href = '{$result->makeUrl('reorder','category','navigation')}'" />
            </td>
        </tr>
        <tr>
            <th width="30%">{$result->translate('Category ID')}</th>
            <td width="70%">{$result->category[category_id]}</td>
        </tr>
        <tr>
            <th width="30%" nowrap="nowrap">{$result->translate('Current Category Name')}</th>
            <td width="70%">
                <div class="error" flexy:if="error[name]">{$result->error[label]}</div>
                <input type="text" name="category[label]" size="40" value="{$result->category[label]}" />
            </td>
        </tr>
        <tr>
            <th width="30%" nowrap="nowrap">{$result->translate('Target Parent Category')}</th>
            <td width="70%"><select name="category[parent_id]" size="1">
                                <option value="0">Top level (No parent)</option>
                                {$result->generateSelect(aCategories,category[parent_id]):h}
                            </select>
            </td>
        </tr>
        <tr>
            <th>{$result->translate('Has Permissions')} ?</th>
            <th>{$result->translate('Role Name')}</th>
        </tr>
        {$result->this.plugin('generatePermsRadioList',perms,'category_id'):h}
        <tr>
            <td colspan="2">
                <strong>{$result->translate('Note')}:</strong> {$result->translate('Permissions are set by default to allow all users into all catgories. If you would like to deny a certain group access to a category, choose "no" in response to "has permissions" for the given group.')}
            </td>
        </tr>
        <tr>
            <td width="100%" colspan="2" align="center" nowrap="nowrap">
                <input name="submitted" type="submit" class="wideButton" value="{$result->translate('Save')}" />
            </td>
        </tr>
    </form>
</table>
<table class="wide">
    <tr>
        <td width="100%" align="center" nowrap="nowrap"> 
            <form name="aDelete" action="" method="post" flexy:ignore id="aDelete">
                <input type="hidden" name="action" value="delete" />
                <input type="hidden" name="frmDelete[{$result->category[category_id]}]" value="{$result->category[category_id]}" />
                    <input type="submit" name="Delete" class="wideButton" value="{$result->translate('Delete')}"
                        onclick="return confirmCategoryDelete('category')" />
            </form>
        </td>
    </tr>
</table>
{$result->end:}
