{include file="user/userModuleSubNav.html"}
<form name="users" method="post" id="users" action="{$result->makeUrl('','user','')}">

    <h1 class="pageTitle">{$result->translate($result->pageTitle)}</h1>
    {if $result->msgGet()}{$result->msgGet()}{/if}
    {if $result->pager}{include file="pager.html"}{/if}
    <div class="alignCenter">{$result->totalItems} {$result->translate('user(s) found')}.
        {if $result->search}
           <a href="{$result->makeUrl('search','usersearch','user','','frmSortBy|sortBy||frmSortOrder|sortOrder')}">{$result->translate('clear search')}</a>
        {/if}
    </div>
    <table class="wide">
        <tr>
            <td colspan="12">
                <input type="button" value="{$result->translate('add user')}" onclick="javascript:document.location.href='{$result->makeUrl('add','user','')}'" />
                <input type="button" value="{$result->translate('search')}"                onclick="javascript:document.location.href='{$result->makeUrl('add','usersearch','user')}'" />
                <input type="button" value="{$result->translate('import users')}" onclick="javascript:document.location.href='{$result->makeUrl('','userImport','')}'" />
           </td>
        </tr>
        <tr>
            <th>{$result->translate('Select')}</th>
            <th><a class="header" href="{$result->makeUrl('list','user','user','','frmSortBy|usr_id||frmSortOrder|sortOrder')}">{$result->translate('User ID')}</a></th>
            <th><a class="header" href="{$result->makeUrl('list','user','user','','frmSortBy|username||frmSortOrder|sortOrder')}">{$result->translate('Username')}</a></th>
            {if $result->conf.OrgMgr.enabled}
                <th>{$result->translate('Organisation')}</th>
            {/if}
            <th>{$result->translate('Email')}</th>
            <th>{$result->translate('Role')}</th>
            <th><a class="header" href="{$result->makeUrl('list','user','user','','frmSortBy|is_acct_active||frmSortOrder|sortOrder')}">{$result->translate('Status')}</a></th>
            <th>{$result->translate('Edit')}</th>
            <th>{$result->translate('Password')}</th>
            <th>{$result->translate('Permissions')}</th>
            <th>{$result->translate('Logins')}</th>
        </tr>

        {foreach from=$result->aPagedData.data key=key item=aValue}
        <tr class="{$result->switchRowClass()}">
            <td align="center"><input class="noBorder" type="checkbox" name="frmDelete[]" value="{$result->aValue.usr_id}" /></td>
            <td>{$aValue.usr_id}</td>
             <td>{$aValue.username}</td>
            {if $result->conf.OrgMgr.enabled}
                <td>{$aValue.org_name}</td>
            {/if}
            <td>{$aValue.email}</td>
            <td>{$aValue.role_name}</td>
            <td align="center">
                {if $aValue.is_acct_active}<a href="{$result->makeUrl('requestChangeUserStatus','user','',$result->aPagedData.data,'frmUserID|usr_id',key)}">{$result->translate('Active')} </a>
                {else} <a href="{$result->makeUrl('requestChangeUserStatus','user','',$result->aPagedData.data,'frmUserID|usr_id',$key)}">{$result->translate('Disabled')}</a>
                {/if}
            </td>
            <td align="center">
                <a href="{$result->makeUrl('edit','user','',$result->aPagedData.data,'frmUserID|usr_id',$key)}">
                    <img src="{$result->webRoot}/themes/{$result->theme}/images/edit.gif" alt="{$result->translate('edit')}" />
                </a>
            </td>

            <td align="center">
                <input type="button" name="frmReset" value="{$result->translate('reset')}"
                    onclick="javascript:document.location.href='{$result->makeUrl('requestPasswordReset','user','',$result->aPagedData.data,'frmUserID|usr_id',$key)}'" />
            </td>
            {if !$result->isAdmin()}
            <td align="center">
                <input type="button" name="frmReset" value="{$result->translate('change')}"
                    onClick="javascript:document.location.href='{$result->makeUrl('editPerms','user','',$result->aPagedData.data,'frmUserID|usr_id',$key)}'" />
            </td>
            {/if}
            {if $result->isAdmin()}
            <td align="center">&nbsp;</td>
            {else}
            <td align="center"><a href="{$result->makeUrl('viewLogin','user','',$result->aPagedData.data,'frmUserID|usr_id',$key)}">list</a></td>
            {/if}
        </tr>
        {/foreach}
        <tr>
            <td colspan="10">{$result->translate('With selected user(s)')}: <input type="submit" name="delete" value="{$result->translate('delete')}" onclick="return confirmSubmit('{$result->translate('user')}', 'users')" />
                <input type="submit" name="syncToRole" value="{$result->translate('sync perms with role')}"
                    onclick="return confirmCustom('{$result->translate('You must select a user to sync')}', '{$result->translate('Are you sure you want to sync this user(s)?')}', 'users')" class="toolBtnSeparate"/>
                <select name="roleSync">
                    <option value="null">{$result->translate('(each users current)')}</option>
                    {$result->generateSelect($result->aRoles)}
                </select>
                <select name="roleSyncMode">
                    {$result->generateSelect($result->aSyncModes)}
                </select>
            </td>
        </tr>
    </table>
</form>
