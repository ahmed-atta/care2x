{include file="user/userModuleSubNav.html"}

<h1 class="$result->pageTitle">{$result->translate($result->pageTitle)}</h1>
<span flexy:if="msgGet()">{$result->msgGet()}</span>

{if $result->pager}{include file="user/pager.html"}{/if}
<form name="frmFilterSwitcher" method="get" flexy:ignore>
<table class="wide">
    <tr>
        <td colspan="5">
        <input type="button" value="{$result->translate('add permission')}" 
            onClick="javascript:document.location.href='{$result->makeUrl('add','permission','user','','frmPermId|moduleId')}'" />
        <input type="button" value="{$result->translate('detect & add permissions')}" 
            onClick="javascript:document.location.href='{$result->makeUrl('scanNew','permission','user','','frmPermId|moduleId')}'" />
        <input type="button" value="{$result->translate('remove orphaned')}" 
            onClick="javascript:document.location.href='{$result->makeUrl('scanOrphaned','permission','user','','frmPermId|moduleId')}'" />
        &nbsp;{$result->translate('filter by module')} 
        <select name="frmModuleId"
                onChange="javascript:document.location.href='{$result->makeUrl('list','permission','user')}frmModuleId/' + getSelectedValue(self.document.frmFilterSwitcher.frmModuleId) + '/';" />    
            <option value="" />
            {$result->translate('all')}                       
            {$result->generateSelect($result->aModules,$result->currentModule)}
        </select>
        </td>
    </tr>
</table>
</form>

<form name="perms" method="post">
<input type="hidden" name="action" value="delete" />
<table class="wide">
    <tr>
        <th>{$result->translate('Select')}</th>
        <th><a class="header" href="{$result->makeUrl('list','permission','user','','frmSortBy|permission_id||frmSortOrder|sortOrder')}">{$result->translate('Perm ID')}</a></th>
        <th><a class="header" href="{$result->makeUrl('list','permission','user','','frmSortBy|name||frmSortOrder|sortOrder')}">{$result->translate('Name')}</a></th>
        <th width="60%">{$result->translate('Description')}</th>
        <th>{$result->translate('Edit')}</th>
    </tr>
    {foreach from=$result->aPagedData.data key=key item=aValue}
    <tr class="{$result->switchRowClass()}">
        <td align="center"><input class="noBorder" type="checkbox" name="frmDelete[]" value="{$aValue.permission_id}" /></td>
        <td>{$aValue.permission_id}</td>
        <td>{$aValue.name}</td>
        <td>{$aValue.description}</td>
        <td align="center"><a href="{$result->makeUrl('edit','permission','user',$result->aPagedData.data,'frmPermId|permission_id',key)}">
            <img src="{$result->webRoot}/themes/{$result->theme}/images/edit.gif" alt="{$result->translate('edit')}" /></a>
        </td>
    </tr>
    {/foreach}
    <tr>
        <td colspan="5">
        {$result->translate('With selected permission(s)')}: 
        <input type="submit" name="delete" value="{$result->translate('delete')}" 
            onClick="return confirmSubmit('{$result->translate('permission')}', 'perms')" />
        </td>
    </tr>
</table>
</form>
