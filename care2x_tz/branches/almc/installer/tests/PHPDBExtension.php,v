head	1.2;
access;
symbols
	care2watu:1.1.0.4
	Root_care2watu:1.1
	dodoma:1.1.0.2
	Root_dodoma:1.1;
locks; strict;
comment	@# @;


1.2
date	2008.12.28.10.51.43;	author timschofield;	state Exp;
branches;
next	1.1;
commitid	3f0f49575a3f4567;

1.1
date	2008.04.01.12.57.20;	author marcel;	state Exp;
branches;
next	;


desc
@@


1.2
log
@*** empty log message ***
@
text
@<?php
/*
 * PHPDBExtension
 *
 * Tests that the database extension for the selected
 * database type is loaded into the running PHP instance
 */

class PHPDBExtension extends BaseTest {

    var $type;

    function PHPDBExtension($params) {
        parent::BaseTest($params);

        if(!is_array($this->params) || count($this->params) <= 0){
            ErrorStack::addError("Invalid parameters, you need to provide the field names", ERRORSTACK_ERROR, 'PHPDBExtension');
            $this->result = INSTALLER_TEST_FAIL;
            return $this->result;
        }
    }

    function prepareParameters() {
        $engine =& $GLOBALS['INSTALLER']['ENGINE'];
        if (isset($this->params['type_field'])) {
            $type_field = $engine->getField($this->params['type_field']);
            $this->type = $type_field->values[0];
        } else if (isset($this->params['type'])) {
            $this->type = $this->params['type'];
        } else {
            $this->result_message = "Could not determine database type, please provide a type_field or type parameter!";
            return FALSE;
        }
        if ($this->type == 'postgres7') $this->type = 'pgsql';
    }

    function perform(){
        if($this->prepareParameters() === FALSE){
            $this->result = INSTALLER_TEST_FAIL;
            return $this->result;
        }

        $this->result_message = "PHP Database Extension $this->type found";
        $this->result = INSTALLER_TEST_SUCCESS;
        if(!extension_loaded($this->type)){
            $this->result = INSTALLER_TEST_FAIL;
            $this->result_message = "PHP Database Extension $this->type is not loaded";
        }

        return $this->result;
    }
}
?>@


1.1
log
@add installer
fixed problem with create user
fixed nursing station view
@
text
@d8 1
a8 1
 
d27 1
a27 1
            $this->type = $type_field->value;
d49 1
a49 1
        
@

